{% render 'rapid-search-results-template-v2' %}
{% paginate collection.products by section.settings.number_of_products_per_page %}
  <div x-data="{ view: 'grid' }" class="px-4 py-8 max-w-7xl mx-auto">

    <!-- Перемикач виду -->
    <div class="flex justify-center mb-6 space-x-4">
      <button
        :class="view === 'grid' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700'"
        class="toggle-btn px-4 py-2 rounded"
        @click="view = 'grid'"
        type="button"
      >
        Grid View
      </button>
      <button
        :class="view === 'list' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700'"
        class="toggle-btn px-4 py-2 rounded"
        @click="view = 'list'"
        type="button"
      >
        List View
      </button>
    </div>

    {% if request.xhr %}
      <aside class="pr-6 mb-6 md:mb-0">
        {% render 'toolbar',
                results: collection,
                enable_filtering: true,
                enable_sorting: true,
                filter_type: "horizontal"
        %}
      </aside>

      <div class="w-full">
        <template x-if="view === 'grid'">
          <div
            class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"
            data-section-id="{{ section.id }}"
            id="ProductGridContainer"
          >
            {% for product in collection.products %}
              {% render 'product-card', product_product: product %}
            {% else %}
              <p class="text-center col-span-full text-gray-500 py-12">
                There are no products inside of this collection
              </p>
            {% endfor %}
          </div>
        </template>

        <template x-if="view === 'list'">
          <div class="flex flex-col space-y-6" id="ProductListContainer">
            {% for product in collection.products %}
              <div class="border p-4 bg-white rounded shadow-sm flex items-center space-x-4">
                {% render 'product-card', product_product: product, list_view: true %}
              </div>
            {% else %}
              <p class="text-center text-gray-500 py-12">
                There are no products inside of this collection
              </p>
            {% endfor %}
          </div>
        </template>
      </div>

      {% render 'pagination', pagination: paginate %}
    {% else %}
      <a href="{{ routes.collections_url }}" class="text-base text-gray-600 hover:underline text-center block mb-6">
        ← Go back to collections
      </a>

      <h1 class="text-3xl font-extrabold text-center mb-8">{{ collection.title }}</h1>

      <div class="flex flex-col md:flex-row gap-8">
        <aside class="md:w-72 pr-6">
          {% render 'toolbar',
                  results: collection,
                  enable_filtering: true,
                  enable_sorting: true,
                  filter_type: "horizontal"
          %}
        </aside>

        <div class="flex-1" id="ProductGridContainer">
          <template x-if="view === 'grid'">
            <div
              class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"
              data-section-id="{{ section.id }}"
            >
              {% for product in collection.products %}
                {% render 'product-card', product_product: product %}
              {% else %}
                <p class="text-center col-span-full text-gray-500 py-12">
                  There are no products inside of this collection
                </p>
              {% endfor %}
            </div>
          </template>

          <template x-if="view === 'list'">
            <div class="flex flex-col space-y-6">
              {% for product in collection.products %}
                <div class="border p-4 bg-white rounded shadow-sm flex items-center space-x-4">
                  {% render 'product-card', product_product: product, list_view: true %}
                </div>
              {% else %}
                <p class="text-center text-gray-500 py-12">
                  There are no products inside of this collection
                </p>
              {% endfor %}
            </div>
          </template>

          <div class="mt-8">
            {% render 'pagination', pagination: paginate %}
          </div>
        </div>
      </div>
    {% endif %}
  </div>
{% endpaginate %}

<style>
  .toggle-btn {
    transition: background-color 0.3s ease, color 0.3s ease;
  }
</style>
